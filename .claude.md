# Claude Code Guidelines for Sanremo

This document contains important guidelines for Claude when making changes to this codebase.

## Project Information

- **GitHub Repository**: https://github.com/SCdF/sanremo/
- **GitHub Actions**: https://github.com/SCdF/sanremo/actions

## Workflow

### Branch Strategy
- **ALWAYS work on branches for code changes**
- If not on a branch when making code changes, create one first
- Branch naming: Use descriptive names like `fix-skipped-tests` or `feature-new-component`
- **I can push branches myself** after pre-commit checks pass
- **I should check GitHub Actions myself** after pushing and report results

## Pre-Commit Checklist

Before committing any code changes, **ALWAYS** run these commands:

### 1. Run Linter
```bash
yarn check
```
This runs Biome to check for:
- Import ordering issues
- Formatting problems
- Code style violations

If there are errors, fix them before committing.

### 2. Run Tests
```bash
yarn test
```
This runs both client and server tests without watching (equivalent to running both with `--run` flag).

For development with watch mode:
```bash
yarn test:client  # Watch client tests only
yarn test:server  # Watch server tests only
```

Ensure all tests pass before committing.

### 3. Verify Both Pass
Only commit when BOTH commands succeed with no errors.

## Why This Matters

- **yarn check**: The build process uses Biome for linting. If linting fails, the CI/CD pipeline will fail.
- **yarn test**: Tests ensure code changes don't break existing functionality.

## After Pushing

After I push a branch:
1. Check GitHub Actions at https://github.com/SCdF/sanremo/actions
2. Use WebFetch to read the latest run and check for failures
3. If failures occur, analyze them and fix them on the branch
4. Remember: Tests may behave differently in CI (different locale, timezone, Node version, etc.)
5. Report results to the user

## Quick Reference

```bash
# 1. Create a branch if not already on one (for code changes)
git checkout -b fix-something

# 2. Make changes, then run pre-commit verification
yarn check && yarn test

# 3. If all pass, commit and push:
git add .
git commit -m "your message"
git push -u origin fix-something

# 4. Check GitHub Actions and report results
```

## Common Gotchas

### Import Ordering

This project uses Biome with specific import ordering rules:
- Library imports (like `@testing-library/react`) come BEFORE React
- React import comes AFTER other library imports
- Use semicolons at the end of import statements

Example:
```javascript
import { screen } from '@testing-library/react';
import React from 'react';
import { MyComponent } from './MyComponent';
```

NOT:
```javascript
import React from 'react';
import { screen } from '@testing-library/react';
```

### Locale-Dependent Tests

Be careful with date/time formatting in tests:
- `toLocaleDateString()` and `toLocaleString()` output varies by locale
- My local environment might format dates differently than CI
- Always use the same formatting method in tests as the component uses
- Example: If component uses `new Date().toLocaleDateString()`, test should too
